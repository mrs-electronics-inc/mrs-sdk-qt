#!/bin/bash

if [[ $# -ne 1 ]]; then
	echo "Usage: mrs-sdk-manager <sdk-version>"
	exit 1
fi

echo "Setting up the MRS SDK..."

readonly MRS_SDK_QT_ROOT="$HOME/mrs-sdk-qt"
readonly MRS_SDK_QT_VERSION="$1"

if [[ -d "${MRS_SDK_QT_ROOT}" ]]; then
	readonly sdk_version_dir="${MRS_SDK_QT_ROOT}/${MRS_SDK_QT_VERSION}"

	if [[ -d "${sdk_version_dir}" ]]; then
		rm "${MRS_SDK_QT_ROOT}/current"
		ln -s "${sdk_version_dir}" "${MRS_SDK_QT_ROOT}/current"

		# Write config file
		readonly config_dir="$HOME/.config/mrs-sdk-qt"
		mkdir -p "${config_dir}"
		cat > "${config_dir}/config" << EOF
MRS_SDK_QT_ROOT=${MRS_SDK_QT_ROOT}
MRS_SDK_QT_VERSION=${MRS_SDK_QT_VERSION}
EOF

		echo "SUCCESS."
	else
		echo "ERROR: could not find directory ${sdk_version_dir}."
		exit 1
	fi
else
	echo "ERROR: could not find SDK installation in ${MRS_SDK_QT_ROOT}."
	exit 1
fi
