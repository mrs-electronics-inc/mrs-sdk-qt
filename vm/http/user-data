#cloud-config
autoinstall:
  version: 1
  interactive-sections: []
  apt:
    preserve_sources_list: false
  
  locale: en_US.UTF-8
  keyboard:
    layout: us
  
  network:
    version: 2
    ethernets:
      id0:
        match:
          macaddress: 52:54:00:*:*:*
        dhcp4: true
  
  storage:
    layout:
      name: direct
    swap:
      size: 0
  
  identity:
    hostname: mrs-sdk-qt
    username: ubuntu
    password: '$6$L7aB1H4mtiNwiEUP$2Wou3TWgLRblDBe6POKWpK2e4SVp5b.jaPKWs20fCoDYw/ITJLQigkkU5YvkYnM.osqM0BVpe4BvOzIzqKtEF.'
    realname: Ubuntu User
  
  ssh:
    install-server: true
    allow-pw: true
    enabled: true
  
  packages:
    - openssh-server
    - openssh-client
    - linux-generic
  
  updates: security
  timezone: UTC
  
  grub:
    install: true
    reboot-with-timeout: 10
  
  early-commands:
    - systemctl stop ssh
  
  late-commands:
    - "sed -i 's/#PermitRootLogin.*/PermitRootLogin yes/' /target/etc/ssh/sshd_config"
    - "echo 'ubuntu:ubuntu' | chpasswd --root /target"
    - systemctl -b enable ssh
    - systemctl -b start ssh
